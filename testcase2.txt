% Advanced test case with records, unions, definetype, nested access
% Tests all major grammar constructs

_compute input parameter list [record #student s1, int count]
output parameter list [int res];

record #student
type int : rollno;
type real : marks;
endrecord

type int : total;
type real : avg;

total <--- count + 2;
avg <--- s1.marks * 1.50;

if (total > 0) then
    res <--- total + 1;
else
    res <--- 0;
endif

return [res];
end

_main

definetype record #student as #pupil

record #student
type int : rollno;
type real : marks;
endrecord

union #result
type int : pass;
type real : percentage;
endunion

type record #student : x1;
type int : a1;
type int : b2;
type #pupil : y1;

read(a1);
read(b2);

a1 <--- a1 + b2 * 3;
b2 <--- (a1 + b2) * 2;

while (a1 < 100)
    a1 <--- a1 + 1;
endwhile

[b2] <--- call _compute with parameters [x1, a1];

write(b2);

if ((a1 > 10) and (b2 < 50)) then
    write(a1);
endif

if (not (a1 == 0)) then
    a1 <--- 0;
endif

return;
end
